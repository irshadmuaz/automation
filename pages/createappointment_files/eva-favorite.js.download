var app=angular.module('evaFavorite',[]);app.provider('$http',$HttpProvider_V_1_5_6);app.controller('evaFavoriteController',function($scope,evaFavoriteService,$sce){$scope.notifications=[];$scope.showEvaFavorite=function(message,command){evaFavoriteService.getCommandVisibility(command).success(function(hasVisibility){if(hasVisibility){let notification={"message":message,"command":command,"actionVisible":true,"bottom":115};if(!$scope.notifications.some(function(notification){return notification.message===message&&notification.command===command})){$scope.notifications.push(notification)}$scope.closeEvaFavoriteInTimeOut(notification)}}).error(function(error){ecwAlert(error)})};$scope.markFavorite=function(notification,id){let response=evaFavoriteService.addToFavorite(notification.command);if(response){notification.message="Command added to favorites successfully. <br>You can click on ASK EVA from any screen to view favorites.";notification.actionVisible=false;for(let i=id+1;i<$scope.notifications.length;i++){$scope.notifications[i].bottom=65}clearTimeout($scope.notifications[id].timeout);$scope.closeEvaFavoriteInTimeOut(notification)}else{notification.message="Failed to add command in Eva favorite:"+notification.command}};$scope.removeFavoriteVisibility=function(notification,notificationIndex){evaFavoriteService.removeVisibility(notification.command);$scope.closeEvaFavorite(notificationIndex)};$scope.closeEvaFavorite=function(index){clearTimeout($scope.notifications[index].timeout);$scope.notifications.splice(index,1)};$scope.closeEvaFavoriteInTimeOut=function(notification){notification.timeout=setTimeout(function(){$scope.notifications.splice(0,1);if($scope.$$phase!=='$apply'&&$scope.$$phase!=='$digest'){$scope.$apply()}},3e4)};$scope.trustAsHtml=function(data){return $sce.trustAsHtml(data)}});app.service('evaFavoriteService',function($http){return{getCommandVisibility:function(command){let endPoint="/mobiledoc/eva/favorite/visibilityConfiguration";let req={method:'GET',url:endPoint,params:{userId:global.TrUserId,commandName:command}};return $http(req)},addToFavorite:function(commandName){let response=urlPost('/mobiledoc/eva/favorite/add',{userId:global.TrUserId,commandName:commandName});if(response){let evaScope=evaService.currentEvaScope;evaScope.postSuccessAddToFavorite(commandName)}return response},removeVisibility:function(command){let endPoint="/mobiledoc/eva/favorite/configureVisibility";let req={method:'POST',url:endPoint,params:{userId:global.TrUserId,commandName:command}};$http(req)},removeFromFavorite:function(commandName){let response=urlPost('/mobiledoc/eva/favorite/remove',{userId:global.TrUserId,commandName:commandName});if(response){let evaScope=evaService.currentEvaScope;evaScope.postSuccessRemoveFromFavorite(commandName)}return response},getUserFavorites:function(){return urlGet('/mobiledoc/eva/favorite/fetchAll?userId='+global.TrUserId)},showEvaFavorite:function(message,command){const isChromeUIScreen=$('#isEdgeRequest').val();if(isChromeUIScreen&&isChromeUIScreen==='true'){return}let evaFavoriteScope=angular.element(document.getElementById('eva-favorite-notification')).scope();evaFavoriteScope.showEvaFavorite(message,command)}}});
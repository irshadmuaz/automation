class Observer{constructor(){this._domNotificationConsumers=[];this._observerConfig={childList:true,subtree:true,characterData:false};this._observe()}_observe(){new MutationObserver(mutations=>this._notifyConsumers(mutations)).observe(document,this._observerConfig)}_notifyConsumers(mutations){this._domNotificationConsumers.forEach(consumer=>{setTimeout((consumerFn,mutationsList)=>{consumerFn(mutationsList)},0,consumer,mutations)})}registerConsumer(consumer){this._domNotificationConsumers.push(consumer)}unregisterConsumer(consumer){this._domNotificationConsumers=this._domNotificationConsumers.filter(c=>c!==consumer)}}window.DOMObserver=new Observer;
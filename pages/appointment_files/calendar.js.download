var browser=new Browser;if(browser.ie4||browser.ie5){document.write("<iframe id='spCal' name='spCal' style='display:none; border:1px solid;position:absolute;width:203px;height:140px;z-index=105' MARGINHEIGHT='0' MARGINWIDTH='0' width:156 SCROLLING='NO'></iframe>")}if(browser.ns6||browser.ns4){document.write("<div id='spCal' name='spCal' class='content' style='display:none; border:ridge;position:fixed;width:203px;height:140px;z-index=4' MARGINHEIGHT='0' MARGINWIDTH='0' width:156 SCROLLING='NO'></div>")}var displayFormat="MM/dd/yyyy";var newformat=displayFormat;function buildCal(){var calDate=new Date;calDateField=arguments[0];CalFrame=document.getElementById("spCal");if(CalFrame==undefined){document.write("<span id='spCal' STYLE='display:none; border:ridge;position:fixed;width:200px;height:140px;z-index=200' MARGINHEIGHT='0' MARGINWIDTH='0' NORESIZE FRAMEBORDER='0' width:156 SCROLLING='NO'></span>");CalFrame=document.getElementById("spCal")}CalFrame.style.left=getAbsX(calDateField)+"px";var eT=calDateField.offsetTop;var eH=calDateField.offsetHeight;var dH=CalFrame.style.pixelHeight;var sT=document.body.scrollTop;CalFrame.style.top=eval(getAbsY(calDateField)+calDateField.size)+"px";switch(isValidDate(calDateField.value)){case 0:calDate=new Date;break;case-1:window.status="invalid date given, using current date";break;case 1:calDate=calDateField.value.toDateTime(newformat);break}if(CalFrame.style.display==""){CalFrame.style.display="none";return}drawCal(calDate);CalFrame.style.display=""}function getDisplayDate(date){return formatDate(date,displayFormat)}function drawCal(dateObj){var sHTML=new String;var objPop;sHTML+='<html><body style="background-color: white"><style>';sHTML+='.calHeading {background-color : Silver; border-top-style: outset; font: 8px Verdana;}';sHTML+='.calRegularDay {background-color : #007f9b;}';sHTML+='A.calRegularDay.HOVER {background-color : #FFFACD;}';sHTML+='.calOtherDay {background-color : #eeeeee;font-family: verdana, arial; font-size : 11px;}';sHTML+='.calToday { font-family : Arial,Helvetica,Sans-serif; font-size : 11px; color : #ffffff;background-color : #DDEDED;}';sHTML+='.calReg, TD.calReg:ACTIVE, TD.calReg:FOCUS, TD.calReg:HOVER, TD.calReg:VISITED {font-family : Arial,Helvetica,Sans-serif;font-size : 11px;}';sHTML+='TD.calReg:HOVER {background-color : #eeeeee }';sHTML+='background-color : #D5D7C3; cursor: hand; display : block;}';sHTML+=' select.month{ font-family : Arial,Helvetica,Sans-serif; font-size : 11px; color : black; width : 75px;}';sHTML+='TD.calReg:VISITED {\tbackground-color : Blue;} </style>';sHTML+='<table cellspacing=0 border=0 cellpadding=0 style="100%">';sHTML+='<tr class="calHeading">';sHTML+='<td width=1></td>';sHTML+='<td width=200></td>';sHTML+='<td width=1></td></tr>';sHTML+='<tr class="heading"><td width=1></td>';sHTML+='<td width=200>';sHTML+=DrawCalendarMonth(dateObj);sHTML+='</tr></table></body></html>';var calobj=document.getElementById("spCal");if(browser.ie4||browser.ie5){self.spCal.document.open();self.spCal.document.write(sHTML);self.spCal.document.close()}if(browser.ns6||browser.ns4){calobj.innerHTML=sHTML}}function DrawCalendarMonth(dateObj){var sCal=new String;var sMonthPicker=new String;var lDay=new Date(dateObj).getDay();var lMonth=new Date(dateObj).getUTCMonth()+1;var lYear=new Date(dateObj).getFullYear();var dcurrDate=new Date(dateObj);monthArray=new Array('January','February','March','April','May','June','July','August','September','October','November','December');weekdayList=new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday');weekdayArray=new Array('Su','Mo','Tu','We','Th','Fr','Sa');var lDaysInMonth=GetDaysInMonth(dcurrDate.getMonth()+1,dcurrDate.getYear());var thisMonthFirstDay=new Date(dcurrDate.getFullYear(),dcurrDate.getMonth(),1);var nextYear=new Date(dcurrDate.getFullYear()+1,dcurrDate.getMonth(),1);var prevYear=new Date(dcurrDate.getFullYear()-1,dcurrDate.getMonth(),1);var nextMonth=new Date(dcurrDate.getFullYear(),dcurrDate.getMonth()+1,1);var prevMonth=new Date(dcurrDate.getFullYear(),dcurrDate.getMonth()-1,1);var sNextYear=thisMonthFirstDay.getUTCMonth()+1+'/'+1+'/'+(thisMonthFirstDay.getFullYear()+1);var sPrevYear=1+'/'+(thisMonthFirstDay.getUTCMonth()+1)+'/'+(thisMonthFirstDay.getFullYear()-1);var sNextMonth=1+'/'+(thisMonthFirstDay.getUTCMonth()+2)+'/'+thisMonthFirstDay.getFullYear();var sPrevMonth=1+'/'+(thisMonthFirstDay.getUTCMonth()+0)+'/'+thisMonthFirstDay.getFullYear();window.status=dateObj;if(parent.drawCal===undefined){sMonthPicker+='<select class="month" name="month" id="month" onchange="javascript:var selectedDate=new Date('+dcurrDate.getFullYear()+',this.selectedIndex, 01);parent.drawCal(selectedDate);">'}else{sMonthPicker+='<select class="month" name="month" id="month" onchange="javascript:var selectedDate=new Date('+dcurrDate.getFullYear()+',this.selectedIndex, 01);parent.drawCal(selectedDate);">'}for(var y=0;y<12;y++){sMonthPicker+='<option value="'+y+'"';if(y==lMonth-1)sMonthPicker+=' selected';sMonthPicker+='>'+monthArray[y]+'</option>'}sMonthPicker+='</select>';sCal='<table width=200 border=1 style="background-color:white;border-collapse:collapse">'+'<tr class="heading" bgcolor="#dedec8">';if(parent.drawCal===undefined){sCal+='<td style="cursor:hand;" onmouseover="this.style.backgroundColor=\'white\';" onmouseout="this.style.backgroundColor=\'\';" onclick="javascript:parent.drawCal(\''+getDisplayDate(prevMonth)+'\')" align=center><font face=verdana, arial size=2>&lt;&lt;</font></td>'}else{sCal+='<td style="cursor:hand;" onmouseover="this.style.backgroundColor=\'white\';" onmouseout="this.style.backgroundColor=\'\';" onclick="javascript:parent.drawCal(\''+getDisplayDate(prevMonth)+'\')" align=center><font face=verdana, arial size=2>&lt;&lt;</font></td>'}sCal+='<td colspan=5 align=center><font face="verdana, arial" size=1>'+sMonthPicker+dcurrDate.getFullYear()+'</font></td>';if(parent.drawCal===undefined){sCal+='<td style="cursor:hand;" onmouseover="this.style.backgroundColor=\'white\';" onmouseout="this.style.backgroundColor=\'\';" onclick="javascript:parent.drawCal(\''+getDisplayDate(nextMonth)+'\');" align=center><font face="verdana, arial" size=2>&gt;&gt;</font></td>'}else{sCal+='<td style="cursor:hand;" onmouseover="this.style.backgroundColor=\'white\';" onmouseout="this.style.backgroundColor=\'\';" onclick="javascript:parent.drawCal(\''+getDisplayDate(nextMonth)+'\');" align=center><font face="verdana, arial" size=2>&gt;&gt;</font></td>'}sCal+='</tr>';weekdays='<tr bgcolor="#aaaaaa">';for(i in weekdayArray){weekdays+='<td align=center><font face="verdana, arial" size=1>'+weekdayArray[i]+'</font></td>'}weekdays+='</TR><TR>';sCal+=weekdays;for(i=0;i<thisMonthFirstDay.getDay();i++){sCal+=DrawOtherDay(thisMonthFirstDay.getDay()-i,dcurrDate)}for(i=1;i<lDaysInMonth+1;i++){dcurrDate.setDate(i);sCal+=DrawNormalDay(i,dcurrDate);if(dcurrDate.getDay()==6){sCal+='</tr><tr>'}}return sCal}function DrawOtherDay(lDayOffset,dDate){var DayNumber;var dWorkingDate=new Date(dDate.getYear(),dDate.getMonth(),-lDayOffset+1);var sTemp=new String;DayNumber=dWorkingDate.getDate();sTemp='<td class="calOtherDay" align=center>';sTemp+='';sTemp+=DayNumber+'</td>';return sTemp}function DrawNormalDay(DayNumber,dDate){var sDayDate=new String;var sTemp=new String;var dToday=new Date;var sClassName='calReg';sDayDate=dDate.getMonth()+1+'/'+DayNumber+'/'+dDate.getFullYear();if(sDayDate==dToday.getMonth()+1+'/'+dToday.getDate()+'/'+dToday.getFullYear()){sClassName='calToday'}sTemp+='<td class="'+sClassName+'" ';if(parent.calDateField===undefined){sTemp+='onclick="javascript:parent.calDateField.value=(\''+getDisplayDate(dDate)+'\'); parent.HideCal();parent.vkCal();"'}else{sTemp+='onclick="javascript:parent.calDateField.value=(\''+getDisplayDate(dDate)+'\'); parent.HideCal();parent.vkCal();"'}sTemp+=' align=center>';sTemp+='<a href="#" onclick="void(\''+sDayDate+'\');">'+DayNumber+'</a></td>';return sTemp}function HideCal(){try{CalFrame.style.display="none"}catch(e){}}function vkCal(){try{dateChanged(calDateField)}catch(e){}}function GetNextMonth(dCurrentDate){var lbmonth;var lbyear;if(dCurrentDate.getMonth==11){dCurrentDate.setMonth(0);dCurrentDate.setYear(dCurrentDate.getYear()+1)}else{dCurrentDate.setMonth(dCurrentDate.getMonth()+1)}return dCurrentDate}function GetDaysInMonth(iMonth,iYear){var dPrevDate=new Date(iYear,iMonth,0);return dPrevDate.getDate()}String.prototype.getDateStr=function(dateformat){re={d:"\\d(\\d|)",m:"([\\d]|)\\d",y:"\\d\\d([\\d]|)([\\d]|)"};tempobj={};for(var i=0;i<3;i++)for(var j in dateformat)if(dateformat[j]==i){dateformat[i]=j;break}var re_str="\\b"+re[dateformat[0]]+"([\\.]|[\\/])"+re[dateformat[1]]+"([.]|[/])"+re[dateformat[2]]+"\\b";var date=this.match(new RegExp(re_str,"gmi"));return date==null?null:date[0].indexOf(".")!=-1&&date[0].indexOf("/")!=-1?null:date[0]};String.prototype.getTimeStr=function(timeformat){var time=this.match(/\b(\d|)\d\:\d\d\b/);return time==null?null:time[0]};function Browser(){this.dom=document.getElementById?1:0;this.ie4=document.all&&!this.dom?1:0;this.ns4=document.layers&&!this.dom?1:0;this.ns6=this.dom&&!document.all?1:0;this.ie5=this.dom&&document.all?1:0;this.ok=this.dom||this.ie4||this.ns4;this.platform=navigator.platform}function isValidDate(sDateIn){switch(true){case Date.UTC(new Date(1970,0,1,0,0,0))==Date.UTC(sDateIn.toDateTime(newformat)):return 0;break;case sDateIn.toDateTime(newformat)!=null:return 1;break;case true:return-1;break}}function formatDate(date,format){format=format+"";var result="";var i_format=0;var c="";var token="";var y=date.getYear()+"";var M=date.getMonth()+1;var d=date.getDate();var E=date.getDay();var H=date.getHours();var m=date.getMinutes();var s=date.getSeconds();var yyyy,yy,MMM,MM,dd,hh,h,mm,ss,ampm,HH,H,KK,K,kk,k;var value=new Object;if(y.length<4){y=""+(y-0+1900)}value["y"]=""+y;value["yyyy"]=y;value["yy"]=y.substring(2,4);value["M"]=M;value["MM"]=LZ(M);value["MMM"]=MONTH_NAMES[M-1];value["NNN"]=MONTH_NAMES[M+11];value["d"]=d;value["dd"]=LZ(d);value["E"]=DAY_NAMES[E+7];value["EE"]=DAY_NAMES[E];value["H"]=H;value["HH"]=LZ(H);if(H==0){value["h"]=12}else if(H>12){value["h"]=H-12}else{value["h"]=H}value["hh"]=LZ(value["h"]);if(H>11){value["K"]=H-12}else{value["K"]=H}value["k"]=H+1;value["KK"]=LZ(value["K"]);value["kk"]=LZ(value["k"]);if(H>11){value["a"]="PM"}else{value["a"]="AM"}value["m"]=m;value["mm"]=LZ(m);value["s"]=s;value["ss"]=LZ(s);while(i_format<format.length){c=format.charAt(i_format);token="";while(format.charAt(i_format)==c&&i_format<format.length){token+=format.charAt(i_format++)}if(value[token]!=null){result=result+value[token]}else{result=result+token}}return result}var MONTH_NAMES=new Array('January','February','March','April','May','June','July','August','September','October','November','December','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec');var DAY_NAMES=new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sun','Mon','Tue','Wed','Thu','Fri','Sat');String.prototype.toDateTime=function(val){val=this;var preferEuro=arguments.length==1?arguments[0]:false;generalFormats=new Array('y-M-d','MMM d, y','MMM d,y','y-MMM-d','d-MMM-y','MMM d');monthFirst=new Array('M/d/y','M-d-y','M.d.y','MMM-d','M/d','M-d');dateFirst=new Array('d/M/y','d-M-y','d.M.y','d-MMM','d/M','d-M');var checkList=new Array('generalFormats',preferEuro?'dateFirst':'monthFirst',preferEuro?'monthFirst':'dateFirst');var d=null;for(var i=0;i<checkList.length;i++){var l=window[checkList[i]];for(var j=0;j<l.length;j++){d=getDateFromFormat(val,l[j]);if(d!=0){return new Date(d)}}}return null};function getDateFromFormat(date_string,format){val=date_string;format=displayFormat+"";var i_val=0;var i_format=0;var c="";var token="";var token2="";var x,y;var now=new Date;var year=now.getYear();var month=now.getMonth()+1;var date=1;var hh=now.getHours();var mm=now.getMinutes();var ss=now.getSeconds();var ampm="";while(i_format<format.length){c=format.charAt(i_format);token="";while(format.charAt(i_format)==c&&i_format<format.length){token+=format.charAt(i_format++)}if(token=="yyyy"||token=="yy"||token=="y"){if(token=="yyyy"){x=4;y=4}if(token=="yy"){x=2;y=2}if(token=="y"){x=2;y=4}year=_getInt(val,i_val,x,y);if(year==null){return 0}i_val+=year.length;if(year.length==2){if(year>70){year=1900+(year-0)}else{year=2e3+(year-0)}}}else if(token=="MMM"||token=="NNN"){month=0;for(var i=0;i<MONTH_NAMES.length;i++){var month_name=MONTH_NAMES[i];if(val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()){if(token=="MMM"||token=="NNN"&&i>11){month=i+1;if(month>12){month-=12}i_val+=month_name.length;break}}}if(month<1||month>12){return 0}}else if(token=="EE"||token=="E"){for(var i=0;i<DAY_NAMES.length;i++){var day_name=DAY_NAMES[i];if(val.substring(i_val,i_val+day_name.length).toLowerCase()==day_name.toLowerCase()){i_val+=day_name.length;break}}}else if(token=="MM"||token=="M"){month=_getInt(val,i_val,token.length,2);if(month==null||month<1||month>12){return 0}i_val+=month.length}else if(token=="dd"||token=="d"){date=_getInt(val,i_val,token.length,2);if(date==null||date<1||date>31){return 0}i_val+=date.length}else if(token=="hh"||token=="h"){hh=_getInt(val,i_val,token.length,2);if(hh==null||hh<1||hh>12){return 0}i_val+=hh.length}else if(token=="HH"||token=="H"){hh=_getInt(val,i_val,token.length,2);if(hh==null||hh<0||hh>23){return 0}i_val+=hh.length}else if(token=="KK"||token=="K"){hh=_getInt(val,i_val,token.length,2);if(hh==null||hh<0||hh>11){return 0}i_val+=hh.length}else if(token=="kk"||token=="k"){hh=_getInt(val,i_val,token.length,2);if(hh==null||hh<1||hh>24){return 0}i_val+=hh.length;hh--}else if(token=="mm"||token=="m"){mm=_getInt(val,i_val,token.length,2);if(mm==null||mm<0||mm>59){return 0}i_val+=mm.length}else if(token=="ss"||token=="s"){ss=_getInt(val,i_val,token.length,2);if(ss==null||ss<0||ss>59){return 0}i_val+=ss.length}else if(token=="a"){if(val.substring(i_val,i_val+2).toLowerCase()=="am"){ampm="AM"}else if(val.substring(i_val,i_val+2).toLowerCase()=="pm"){ampm="PM"}else{return 0}i_val+=2}else{if(val.substring(i_val,i_val+token.length)!=token){return 0}else{i_val+=token.length}}}if(i_val!=val.length){return 0}if(month==2){if(year%4==0&&year%100!=0||year%400==0){if(date>29){return 0}}else{if(date>28){return 0}}}if(month==4||month==6||month==9||month==11){if(date>30){return 0}}if(hh<12&&ampm=="PM"){hh=hh-0+12}else if(hh>11&&ampm=="AM"){hh-=12}var newdate=new Date(year,month-1,date,hh,mm,ss);return newdate.getTime()}function _isInteger(val){var digits="1234567890";for(var i=0;i<val.length;i++){if(digits.indexOf(val.charAt(i))==-1){return false}}return true}function _getInt(str,i,minlength,maxlength){for(var x=maxlength;x>=minlength;x--){var token=str.substring(i,i+x);if(token.length<minlength){return null}if(_isInteger(token)){return token}}return null}function LZ(x){return(x<0||x>9?"":"0")+x}function getAbsX(elt){return elt.x?elt.x:getAbsPos(elt,"Left")}function getAbsY(elt){return elt.y?elt.y:getAbsPos(elt,"Top")}function getAbsPos(elt,which){iPos=0;while(elt!=null){iPos+=elt["offset"+which];elt=elt.offsetParent}return iPos}
(function(){function addStyling(data){let virtualScrollerTop=angular.element(data.scroller).scrollTop();let scrollIndex=Math.round(virtualScrollerTop/144);let keys=Object.keys(data.repeater.blocks);let yIndex=keys.findIndex(function(p){return p==scrollIndex});angular.element(angular.element(data.offsetter).find('.md-calendar tbody')).removeClass('current-month');angular.element(angular.element(data.offsetter).find('.md-calendar tbody')[yIndex]).addClass('current-month');angular.element(angular.element(data.scroller).closest('.md-date-col').find('.md-current_month').empty());angular.element(angular.element(data.offsetter).find('.md-calendar tbody').find('.md-calendar-month-label')).removeClass('the-selected');angular.element(angular.element(data.offsetter).find('.md-calendar tbody')[yIndex]).find('.md-calendar-month-label').addClass('the-selected');let toappend=angular.element(angular.element(data.scroller).closest('.md-date-col').find('.md-current_month'));angular.element(angular.element(data.offsetter).find('.md-calendar tbody')[yIndex]).find('.md-calendar-month-label.the-selected').clone().appendTo(toappend)}angular.module('calendarApp',['ngMaterialDatepicker','ngMessages','material.svgAssetsCache']).directive('dateClearable',function(){let directive={restrict:'A',require:'ngModel',link:link};return directive;function link(scope,elem,attrs,ctrl){elem.addClass('clearable');elem.bind('input',bindInput);function bindInput(){elem[toggleClass(elem.val())]('x')}elem.on('mousemove',function(e){if(elem.hasClass('x')){elem[toggleClass(this.offsetWidth-25<e.clientX-this.getBoundingClientRect().left)]('onX')}});elem.on('click',function(e){if(elem.hasClass('onX')){elem.removeClass('x onX').val(undefined);ctrl.$setViewValue(undefined);ctrl.$render();scope.$digest();if(elem.scope().clearSingleDatePicker)elem.scope().clearSingleDatePicker();else if(elem.scope().clearCallback){if(e.currentTarget.name==='startDate'){elem.scope().dateObj.startDate=null;elem.scope().dateObj.startDatepicker=null}else if(e.currentTarget.name==='endDate'){elem.scope().dateObj.endDate=null;elem.scope().dateObj.endDatepicker=null}elem.scope().rangeCount=0;elem.scope().clearCallback({controlName:e.currentTarget.name})}}});function toggleClass(v){return v?'addClass':'removeClass'}function cleanUp(){elem.unbind('input',bindInput)}scope.$on('$destroy',cleanUp)}}).directive('ngDateEnter',function(){return function(scope,element,attrs){function bindKeydownAndKeyPress(event){if(event.which===13||event.which===32){scope.$apply(function(){scope.$eval(attrs.ngDateEnter)});event.preventDefault()}}element.bind("keydown keypress",bindKeydownAndKeyPress);function cleanUp(){element.unbind('keydown keypress',bindKeydownAndKeyPress)}scope.$on('$destroy',cleanUp)}}).directive('onOutsideElementClick',function($document,$rootScope){return{restrict:'A',link:function(scope,element,attrs){element.on('click',function(e){e.stopPropagation()});function onClick(){if(!$rootScope.$$phase){scope.$apply(function(){scope.$eval(attrs.onOutsideElementClick)})}}$document.on('click',onClick);scope.$on('$destroy',function(){$document.off('click',onClick)})}}}).directive('singleDatePicker',function($timeout){return{restrict:'E',require:'^?form',scope:{dateObj:'=',showButtonPanel:'=',showCloseButton:'=?',minDate:'=',maxDate:'=',oneYearRange:'@',onInputDateChangeCallback:'&',customCallback:'&',clearCallback:'&',showDays:'@'},template:'<div class="dropdown col-sm-12 nopadding md-datepicker-container" ng-class="{\'open\':dateObj.openSingleDatePicker}" on-outside-element-click="dateObj.openSingleDatePicker = false" >'+'<div class="form-group nomargin dropdown-toggle col-sm-12 nopadding">'+'<div class="col-sm-12 nopadding input-group input-group-sm" ng-class="{\'md-highlight-date\':dateObj.openSingleDatePicker}">'+'<input ng-readonly="dateObj.readOnly.inputField" ng-class="{\'x onX\' :!dateObj.readOnly.inputField }" name="datename" ng-blur="checkValidation()" type="date" min="{{minDateForValidation}}" max="{{maxDateForValidation}}" class="form-control clearable" date-clearable ng-date-enter="!dateObj.readOnly.inputField && !dateObj.readOnly.calenderIcon && openDatePicker($event)" ng-change="markDateAsChanged()" ng-model="dateObj.singleDatepicker">'+'<span class="input-group-addon calenderIconSunoh" ng-click="!dateObj.readOnly.calenderIcon && openDatePicker($event)">'+'<i ng-class="{\'disabled\': dateObj.readOnly.calenderIcon}" class="icon md-icon-calendar"></i>'+'</span>'+'</div>'+'<div class="md-date-alert"  style="display:none">Please enter a valid Date</div>'+'</div>'+'<div class="md-datepicker-dropdown dropdown-menu" ng-class="{\'md-single-datepicker\':!showButtonPanel}">'+' <div class="md-date-col start-date" ng-class="{\'md-date-column-focused\':showButtonPanel}">'+'<p class="md-current_month pull-left" ng-click="triggerClick($event)"></p><p>&nbsp;&nbsp;</p>'+' <md-calendar ng-if="dateObj.openSingleDatePicker" class="singlepicker" aria-label="start" ng-model="dateObj.singleDate" md-min-date="minDate" md-max-date="maxDate" md-placeholder="Start date" ng-change="onDateChanged()">'+'</md-calendar>'+'</div>'+'<div class="md-single-datepicker-footer" ng-if="!showButtonPanel">'+'<button type="button" class="btn btn-sm md-btn-clear" ng-click="clearSingleDatePicker($event)">Clear</button>'+'<button type="button" class="btn btn-sm md-btn-close ml5" ng-if="showCloseButton" ng-click="dateObj.openSingleDatePicker = false">Close</button>'+'<button type="button" class="btn btn-sm pull-right md-btn-close" ng-click="selectCurrentDate($event)">Today</button>'+'</div>'+'<div class="md-date-col md-ranges-section" style="width: 200px !important;" ng-if="showButtonPanel" layout="column" flex-order="0" flex-order-gt-sm="2" ng-init="openInfoTooltip=false">'+'<label class="md-text-bold md-pad-5">Shortcuts</label>'+'<i class="icon md-icon-info pull-right" ng-mouseover="openInfoTooltip=true" ng-mouseout="openInfoTooltip=false"></i>'+'<div class="tooltip-popover" ng-show="openInfoTooltip">Shortcuts Info:'+'<div><span class="fnt-bold">To select the current date:</div>'+'<div>1. Click on the Today button</div>'+'<div>2. Click on the Done button</div>'+'<div><span class="fnt-bold">To select a date in the past (ex: 4 weeks ago):</div>'+'<div>1. Click on the Last button</div>'+'<div>2. Click on the 4 wks button</div>'+'<div>3. Click on the Done button</div>'+'<div><span class="fnt-bold">To select a date in the future (ex: 1 year from now):</div>'+'<div>1. Click on the Next button</div>'+'<div>2. Click on the 1 yr button</div>'+'<div>3. Click on the Done button</div>'+'<div><span class="fnt-bold">To remove the selections made on the calendar :</div>'+'<div>1. Click on the Clear button</div>'+'<div>2. Click on the Done button</div>'+'</div>'+'<div class="md-range-content">'+' <div class="btn-group clearfix md-range-selection-group" ng-init="dateObj.rangeSelection=\'next\'">'+'<button type="button" class="btn btn-default btn-sm" ng-disabled="disableLast" ng-class="{\'active\':dateObj.rangeSelection==\'last\'}"'+' ng-click="prevShortcutSelection()">Last</button>'+'<button type="button" class="btn btn-default btn-sm" ng-disabled="disableNext" ng-class="{\'active\':dateObj.rangeSelection==\'next\'}"'+' ng-click="nextShortcutSelection()">Next</button>'+'</div>'+'<div class="md-ranges-grid">'+'<button type="button" class="btn btn-sm md-datepicker-current"'+' ng-class="{\'active\':activeShortcut==\'days\' && rangeDateCount==2}" ng-if="showDays" '+' ng-click="selectDateShortcut(\'days\',2)">2D</button>'+'<button type="button" class="btn btn-sm md-datepicker-current"'+' ng-class="{\'active\':activeShortcut==\'days\' && rangeDateCount==3}" ng-if="showDays" '+' ng-click="selectDateShortcut(\'days\',3)">3D</button>'+'<button type="button" class="btn btn-sm md-datepicker-current"'+' ng-class="{\'active\':activeShortcut==\'weeks\' && rangeDateCount==1}" ng-if="showDays" '+' ng-click="selectDateShortcut(\'weeks\',1)">1 wk</button>'+'<button type="button" class="btn btn-sm md-datepicker-current"'+' ng-class="{\'active\':activeShortcut==\'weeks\' && rangeDateCount==2}" ng-if="showDays" '+' ng-click="selectDateShortcut(\'weeks\',2)">2 wks</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'weeks\' && rangeDateCount==3}"'+' ng-click="selectDateShortcut(\'weeks\',3)">3 wks</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'weeks\' && rangeDateCount==4}"'+' ng-click="selectDateShortcut(\'weeks\',4)">4 wks</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'weeks\' && rangeDateCount==6}"'+' ng-click="selectDateShortcut(\'weeks\',6)">6 wks</button>'+' <button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'months\' && rangeDateCount==2}"'+' ng-click="selectDateShortcut(\'months\',2)">2  mos</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'months\' && rangeDateCount==3}"'+' ng-click="selectDateShortcut(\'months\',3)">3 mos</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'months\' && rangeDateCount==4}"'+' ng-click="selectDateShortcut(\'months\',4)">4 mos</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'months\' && rangeDateCount==6}"'+'  ng-click="selectDateShortcut(\'months\',6)">6 mos</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'year\' && rangeDateCount==1}"'+'ng-click="selectDateShortcut(\'year\',1)">1 yr</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-if="!oneYearRange" ng-class="{\'active\':activeShortcut==\'year\' && rangeDateCount==2}"'+' ng-click="selectDateShortcut(\'year\',2)">2 yrs</button>'+'<button type="button" class="btn btn-sm md-datepicker-current"'+' ng-class="{\'active\':activeShortcut==\'year\' && rangeDateCount==3}" ng-if="!oneYearRange" '+' ng-click="selectDateShortcut(\'year\',3)">3 yrs</button>'+'<button type="button" class="btn btn-sm md-datepicker-current"'+' ng-class="{\'active\':activeShortcut==\'year\' && rangeDateCount==4}" ng-if="!oneYearRange" '+' ng-click="selectDateShortcut(\'year\',4)">4 yrs</button>'+'<button type="button" class="btn btn-sm md-datepicker-current"'+' ng-class="{\'active\':activeShortcut==\'year\' && rangeDateCount==5}" ng-if="!oneYearRange" '+' ng-click="selectDateShortcut(\'year\',5)">5 yrs</button>'+'</div>'+'<div class="md-datepicker-footer">'+'<button type="button" class="btn btn-xs btn-lgrey mr10"'+' ng-class="{\'active\':activeShortcut==\'today\' && rangeDateCount==0}"'+' ng-click="selectDateShortcut(\'today\',0)">Today</button>'+'<button type="button" class="btn btn-sm md-btn-clear" ng-click="clearDatePicker($event)">Clear</button>'+'<button type="button" class="btn btn-sm pull-right md-btn-close" ng-click="closeDatePicker($event)">Done</button>'+'</div>'+'</div>'+'</div>'+'</div>'+'</div>',link:function(scope,element,attr,ngModel){if(scope.dateObj.singleDatepicker){scope.dateObj.singleDatepicker.setHours(0,0,0,0)}let currentDate=new Date(scope.dateObj.singleDatepicker);let timeoutReference;let timeout=500;scope.activeShortcut='today';scope.rangeDateCount=0;if(!scope.showCloseButton){scope.showCloseButton=false}if(scope.dateObj.isDefaultSelected){scope.customCallback()}scope.nextShortcutSelection=nextShortcutSelection;scope.prevShortcutSelection=prevShortcutSelection;scope.openDatePicker=openDatePicker;scope.closeDatePicker=closeDatePicker;scope.clearDatePicker=clearDatePicker;scope.selectCurrentDate=selectCurrentDate;scope.clearSingleDatePicker=clearSingleDatePicker;scope.selectDateShortcut=selectDateShortcut;scope.checkValidation=checkValidation;scope.markDateAsChanged=markDateAsChanged;if(scope.minDate){scope.minDateForValidation=scope.minDate.format("yyyy-mm-dd")}else{scope.minDateForValidation="1880-01-01"}if(scope.maxDate){scope.maxDateForValidation=scope.maxDate.format("yyyy-mm-dd")}else{scope.maxDateForValidation="2130-12-31"}function nextShortcutSelection(){scope.dateObj.rangeSelection='next';scope.activeShortcut=null;scope.rangeDateCount=null}function prevShortcutSelection(){scope.dateObj.rangeSelection='last';scope.activeShortcut=null;scope.rangeDateCount=null}element.on('keyup',function(){executeValidationOnTimeOut()});element.on('keydown',function(){clearTimeout(timeoutReference)});function executeValidationOnTimeOut(){if(!ngModel.$valid){clearTimeout(timeoutReference);timeoutReference=setTimeout(launchValidationPopUp,timeout)}}function checkValidation(){if(!ngModel.$valid){executeValidationOnTimeOut();$(element[0].querySelector("input[name=datename]")).focus()}}function launchValidationPopUp(){let message="Please enter a valid Date";if(ngModel.$error.min){message="Enter valid future date"}else if(ngModel.$error.max){message="Enter valid past date"}element[0].querySelector(".md-date-alert").innerText=message;$(element[0].querySelector(".md-date-alert")).fadeIn().delay(1e3).fadeOut()}function openDatePicker(){scope.activeShortcut='';if(scope.dateObj.singleDate){scope.dateObj.singleDate=scope.dateObj.singleDatepicker?scope.dateObj.singleDatepicker:new Date}scope.dateObj.openSingleDatePicker=true;if(scope.dateObj.singleDate){scope.dateObj.singleDate=new Date(scope.dateObj.singleDate.setHours(0,0,0,0))}if(scope.maxDate&&scope.dateObj.singleDate){if(scope.dateObj.singleDate.toLocaleDateString()===scope.maxDate.toLocaleDateString()){scope.disableNext=true;scope.dateObj.rangeSelection='last'}}if(scope.minDate&&scope.dateObj.singleDate){if(scope.dateObj.singleDate.toLocaleDateString()===scope.minDate.toLocaleDateString()){scope.disableLast=true;scope.dateObj.rangeSelection='next'}}if(!scope.dateObj.singleDate){$timeout(function(){$('td[class*=md-calendar-date-today]').attr('class','md-calendar-date')},100)}}function closeDatePicker(){scope.dateObj.openSingleDatePicker=false;if(scope.dateObj.singleDate!=null){scope.dateObj.singleDatepicker=new Date(scope.dateObj.singleDate)}else{scope.dateObj.singleDatepicker=null}executeValidationOnTimeOut();scope.customCallback()}function clearDatePicker(e){removeXIconClass(e);scope.dateObj.singleDate=null;scope.dateObj.singleDatepicker=null;scope.rangeCount=0}function selectCurrentDate(){scope.dateObj.singleDate=new Date;scope.onDateChanged();scope.dateObj.openSingleDatePicker=false}function clearSingleDatePicker(){scope.dateObj.singleDate=null;scope.dateObj.singleDatepicker=null;scope.clearCallback()}function markDateAsChanged(){if(scope.onInputDateChangeCallback){scope.onInputDateChangeCallback()}}function selectDateShortcut(range,count){scope.activeShortcut=range;scope.rangeDateCount=count;currentDate=scope.dateObj.singleDatepicker==null||scope.dateObj.singleDatepicker==''?new Date:new Date(scope.dateObj.singleDatepicker);currentDate.setHours(0,0,0,0);switch(range){case'today':currentDate=new Date;currentDate.setHours(0,0,0,0);scope.dateObj.singleDate=currentDate;break;case'days':if(scope.dateObj.rangeSelection==='last'){currentDate.setDate(currentDate.getDate()-1*scope.rangeDateCount)}else{currentDate.setDate(currentDate.getDate()+1*scope.rangeDateCount)}break;case'weeks':if(scope.dateObj.rangeSelection==='last'){currentDate.setDate(currentDate.getDate()-7*scope.rangeDateCount)}else{currentDate.setDate(currentDate.getDate()+7*scope.rangeDateCount)}break;case'months':if(scope.dateObj.rangeSelection==='last'){currentDate.setMonth(currentDate.getMonth()-scope.rangeDateCount)}else{currentDate.setMonth(currentDate.getMonth()+scope.rangeDateCount)}break;case'year':if(scope.dateObj.rangeSelection==='last'){currentDate.setFullYear(currentDate.getFullYear()-scope.rangeDateCount)}else{currentDate.setFullYear(currentDate.getFullYear()+scope.rangeDateCount)}break}scope.dateObj.singleDate=currentDate;if(!scope.showButtonPanel){scope.dateObj.openSingleDatePicker=false;scope.dateObj.singleDatepicker=scope.dateObj.singleDate}}let singleListener=scope.$watch(function(){return scope.dateObj.singleDatepicker},function(){if(!scope.dateObj.readOnly||!scope.dateObj.readOnly.inputField){resetXIcon()}},true);scope.$on("$destroy",function(){singleListener()});scope.$on("virtualScroll",function(selfEve,data){setTimeout(function(){addStyling(data)},200)});function cleanUp(){if(timeoutReference){clearTimeout(timeoutReference)}}scope.$on('$destroy',cleanUp)},controller:function($log,$scope){$scope.onDateChanged=onDateChanged;$scope.triggerClick=triggerClick;function onDateChanged(){if(!$scope.showButtonPanel){$scope.dateObj.openSingleDatePicker=false;$scope.dateObj.singleDatepicker=$scope.dateObj.singleDate;$scope.customCallback()}$scope.dateObj.singleDatepicker=new Date($scope.dateObj.singleDate.setHours(0,0,0,0));let currentDate=new Date((new Date).setHours(0,0,0,0));if($scope.dateObj.singleDatepicker.toDateString()===currentDate.toDateString()){$scope.activeShortcut='today'}else{$scope.activeShortcut=''}}function triggerClick($event){$($event.currentTarget).closest('.start-date').find('tbody').find('.the-selected').trigger('click')}}}}).directive('dateRangePicker',function($timeout){return{restrict:'E',require:'^?form',scope:{dateObj:'=',ngModel:"=",minDate:'=',maxDate:'=',oneYearRange:'@',customCallback:'&',onOutsideCalendarClickCallback:'&',clearCallback:'&',fixToLabelStyling:"=",showDays:'@'},template:'<div class="dropdown col-sm-12 nopadding md-datepicker-container" ng-class="{\'open\':dateObj.openDatepickerRange}" on-outside-element-click="onOutsideCalendarClick()">'+'<div class="form-group nomargin dropdown-toggle col-sm-12 nopadding">'+'<div class="col-sm-6 nopadleft">'+'<label class="md-text-bold labelOrientationLeft" ng-if="dateObj.label.startDate.name" ng-class = "{\'labelOrientationTop\':dateObj.label.startDate.orientation == \'top\'}" >{{dateObj.label.startDate.name}} <span ng-if="dateObj.label.startDate.required" class="red_txt">*</span></label>'+'<div class="input-group input-group-sm custom-date-picker" ng-validate="dateObj.startDatepicker" ng-class="{\'md-highlight-date\':focusStartDate==true && dateObj.openDatepickerRange == true}">'+'<input ng-readonly="dateObj.readOnly.inputField" type="date" ng-blur="checkValidation()" min="{{minDateForValidation}}" max="{{maxDateForValidation}}" name="startDate" class="form-control clearable " ng-class="{\'x onX\' :!dateObj.readOnly.inputField }" ng-date-enter="!dateObj.readOnly.inputField && !dateObj.readOnly.calenderIcon && openRangePicker($event)" ng-model="dateObj.startDatepicker" date-clearable>'+'<span class="input-group-addon" ng-click="!dateObj.readOnly.calenderIcon && openRangePicker($event)">'+'<i class="icon md-icon-calendar"></i>'+'</span>'+' </div>'+'<div class="md-date-alert start-date-msg" style="display:none">Please enter a valid Date</div>'+'</div>'+'<div class="col-sm-6 nopadright" ng-class = "{\'customFromDateStyling\': fixToLabelStyling}">'+'<div class="" id="endDate">'+'<label class="md-text-bold labelOrientationLeft" ng-class = "{\'labelOrientationTop\':dateObj.label.endDate.orientation == \'top\',\'customToLabelStyling\': fixToLabelStyling}">{{dateObj.label.endDate.name}}</label>'+'<div class="input-group input-group-sm" ng-class="{\'md-highlight-date\':focusEndDate==true && dateObj.openDatepickerRange == true}">'+'<input ng-readonly="{{dateObj.readOnly.inputField}}" type="date" ng-blur="checkValidation()" min="{{minDateForValidation}}" max="{{maxDateForValidation}}" name="endDate" class="form-control clearable" ng-class="{\'x onX\' :!dateObj.readOnly.inputField }" ng-date-enter="!dateObj.readOnly.inputField && openRangePicker($event)" ng-model="dateObj.endDatepicker" date-clearable>'+'<span class="input-group-addon" ng-click="!dateObj.readOnly.calenderIcon && openRangePicker($event)">'+' <i class="icon md-icon-calendar"></i>'+'</span>'+'</div>'+'<div class="md-date-alert end-date-msg" style="display:none">Please enter a valid Date </div>'+'</div>'+' </div>'+' </div>'+' <style> .width733 {width: 733 px !important;} .width471 {width: 471px !important;}</style>'+'<div class="md-datepicker-dropdown dropdown-menu" ng-class="{\'width471\':dateObj.hideStartDatePicker==true,\'width733\':!dateObj.hideStartDatePicker}" ng-init="focusEndDate=true">'+'<div class="md-date-col start-date" ng-if="!dateObj.hideStartDatePicker" ng-class="{\'md-date-column-focused\':focusStartDate==true}">'+'<p class="md-current_month pull-left" ng-click="triggerClick($event)"></p><p>Start Date</p>'+'<md-calendar ng-if="dateObj.openDatepickerRange" aria-label="start" md-is-open="dateObj.openDatepickerRange" ng-model="dateObj.startDate" md-min-date="minDate" md-max-date="maxDate" md-placeholder="Start date" ng-change="onDateChanged()">'+'</md-calendar>'+'</div>'+' <div class="md-date-col end-date" ng-class="{\'md-date-column-focused\':focusEndDate == true}">'+'<p class="md-current_month pull-left" ng-click="triggerEndClick($event)"></p><p>End Date</p>'+' <md-calendar ng-if="dateObj.openDatepickerRange" aria-label="end" md-is-open="dateObj.openDatepickerRange" ng-model="dateObj.endDate" md-min-date="minDate" md-max-date="maxDate" md-placeholder="End date" ng-change="onDateChanged()">'+' </md-calendar>'+'</div>'+'<div class="md-date-col md-ranges-section"  style="width: 200px !important;" layout="column" flex-order="0" flex-order-gt-sm="2" ng-init="openInfoTooltip=false">'+'<label class="md-text-bold md-pad-5">Date Range</label>'+'<i class="icon md-icon-info pull-right" ng-mouseover="openInfoTooltip=true" ng-mouseout="openInfoTooltip=false"></i>'+'<div class="tooltip-popover" ng-show="openInfoTooltip">Shortcuts Info:'+'<div><span class="md-fnt-bold">To select the current date:</div>'+'<div>1. Click on the Today button</div>'+'<div>2. Click on the Done button</div>'+'<div><span class="md-fnt-bold">To select a date in the past (ex: 4 weeks ago):</div>'+'<div>1. Click on the Last button</div>'+'<div>2. Click on the 4 wks button</div>'+'<div>3. Click on the Done button</div>'+'<div><span class="md-fnt-bold">To select a date in the future (ex: 1 year from now):</div>'+'<div>1. Click on the Next button</div>'+'<div>2. Click on the 1 yr button</div>'+'<div>3. Click on the Done button</div>'+'<div><span class="md-fnt-bold">To remove the selections made on the calendar :</div>'+'<div>1. Click on the Clear button</div>'+'<div>2. Click on the Done button</div>'+'</div>'+'<div class="md-range-selection-group">'+' <div class="btn-group clearfix md-range-selection-group" ng-init="rangeSelection=\'next\'">'+'<button type="button" class="btn btn-default btn-sm prev-button" ng-class="{\'active\':rangeSelection==\'last\'}" ng-disabled="disableLast" ng-click="prevShortcutSelection()">Last</button>'+'<button type="button" class="btn btn-default btn-sm next-button" ng-class="{\'active\':rangeSelection==\'next\'}" ng-disabled="disableNext" ng-click="nextShortcutSelection()">Next</button>'+'</div>'+'<div class="md-ranges-grid">'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'days\' && rangeDateCount==2}" ng-if="showDays" ng-click="selectRange(\'days\',2)">2D</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'days\' && rangeDateCount==3}" ng-if="showDays" ng-click="selectRange(\'days\',3)">3D</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'weeks\' && rangeDateCount==1}" ng-if="showDays" ng-click="selectRange(\'weeks\',1)">1 wk</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeShortcut==\'weeks\' && rangeDateCount==2}" ng-if="showDays" ng-click="selectRange(\'weeks\',2)">2 wks</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'weeks\' && rangeCount==3}" ng-click="selectRange(\'weeks\',3,$event)">3 wks</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'weeks\' && rangeCount==4}" ng-click="selectRange(\'weeks\',4,$event)">4 wks</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'weeks\' && rangeCount==6}" ng-click="selectRange(\'weeks\',6,$event)">6 wks</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'months\' && rangeCount==1}" ng-click="selectRange(\'months\',1,$event)">1 mos</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'months\' && rangeCount==2}" ng-click="selectRange(\'months\',2,$event)">2 mos</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'months\' && rangeCount==3}" ng-click="selectRange(\'months\',3,$event)">3 mos</button>'+' <button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'months\' && rangeCount==4}" ng-click="selectRange(\'months\',4,$event)">4 mos</button>'+' <button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'months\' && rangeCount==6}" ng-click="selectRange(\'months\',6,$event)">6 mos</button>'+' <button type="button" class="btn btn-sm md-datepicker-current" ng-class="{\'active\':activeRange==\'year\' && rangeCount==1}" ng-click="selectRange(\'year\',1,$event)">1 yr</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-if="!oneYearRange" ng-class="{\'active\':activeRange==\'year\' && rangeCount==2}" ng-click="selectRange(\'year\',2,$event)">2 yrs</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-if="!oneYearRange" ng-class="{\'active\':activeRange==\'year\' && rangeCount==3}" ng-click="selectRange(\'year\',3,$event)">3 yrs</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-if="!oneYearRange" ng-class="{\'active\':activeRange==\'year\' && rangeCount==4}" ng-click="selectRange(\'year\',4,$event)">4 yrs</button>'+'<button type="button" class="btn btn-sm md-datepicker-current" ng-if="!oneYearRange" ng-class="{\'active\':activeRange==\'year\' && rangeCount==5}" ng-click="selectRange(\'year\',5,$event)">5 yrs</button>'+'</div>'+' <div class="md-datepicker-footer">'+'<button type="button" class="btn btn-xs btn-lgrey mr10" ng-class="{\'active\':activeRange==\'today\' && rangeCount==0}" ng-click="selectRange(\'today\',0, $event)">Today</button>'+'<button type="button" class="btn btn-sm md-btn-clear" ng-click="clearDate($event)">Clear</button>'+'<button type="button" class="btn btn-sm pull-right md-btn-close" ng-click="close($event)">Done</button>'+' </div>'+'</div>'+'</div>'+'</div> '+'</div>',link:function(scope,element,attr,ngModel){scope.rangeCount=0;if(scope.dateObj.startDatepicker){scope.dateObj.startDatepicker.setHours(0,0,0,0)}if(scope.dateObj.endDatepicker){scope.dateObj.endDatepicker.setHours(0,0,0,0)}let timeoutReference;let timeout=800;if(scope.minDate){scope.minDateForValidation=scope.minDate.format("yyyy-mm-dd")}else{scope.minDateForValidation="1880-01-01"}if(scope.maxDate){scope.maxDateForValidation=scope.maxDate.format("yyyy-mm-dd")}else{scope.maxDateForValidation="2130-12-31"}function executeValidationOnTimeOut(){clearTimeout(timeoutReference);if(!ngModel.$valid){timeoutReference=setTimeout(launchValidationPopUp,timeout)}}function checkValidation(){executeValidationOnTimeOut();if(!ngModel.$valid){let inputSelector;if(ngModel.$error.min&&ngModel.$error.min[0].$name=="startDate"||ngModel.$error.max&&ngModel.$error.max[0].$name=="startDate"||ngModel.$error.date&&ngModel.$error.date[0].$name=="startDate"){inputSelector="input[name=startDate]"}else if(ngModel.$error.min&&ngModel.$error.min[0].$name=="endDate"||ngModel.$error.max&&ngModel.$error.max[0].$name=="endDate"||ngModel.$error.date&&ngModel.$error.date[0].$name=="endDate"){inputSelector="input[name=endDate]"}$(element[0].querySelector(inputSelector)).focus()}}function getValidationMsg(){let message="Please enter a valid Date";if(ngModel.$error.min){message="Enter valid future date"}else if(ngModel.$error.max){message="Enter valid past date"}else if(ngModel.$error.date){message="Enter valid date"}return message}function launchValidationPopUp(){let inputSelector;if(ngModel.$error.min&&ngModel.$error.min[0].$name=="startDate"||ngModel.$error.max&&ngModel.$error.max[0].$name=="startDate"||ngModel.$error.date&&ngModel.$error.date[0].$name=="startDate"){inputSelector="div.start-date-msg"}else if(ngModel.$error.min&&ngModel.$error.min[0].$name=="endDate"||ngModel.$error.max&&ngModel.$error.max[0].$name=="endDate"||ngModel.$error.date&&ngModel.$error.date[0].$name=="endDate"){inputSelector="div.end-date-msg"}element[0].querySelector(inputSelector).innerText=getValidationMsg();$(element[0].querySelector(inputSelector)).fadeIn().delay(1e3).fadeOut()}scope.nextShortcutSelection=nextShortcutSelection;scope.prevShortcutSelection=prevShortcutSelection;scope.closeAlert=closeAlert;scope.openRangePicker=openRangePicker;scope.onOutsideCalendarClick=onOutsideCalendarClick;scope.clearDate=clearDate;scope.close=close;scope.selectRange=selectRange;scope.checkValidation=checkValidation;function nextShortcutSelection(){if(scope.dateObj.hideStartDatePicker){return}scope.rangeSelection='next';scope.focusStartDate=false;scope.focusEndDate=true;scope.activeRange=null;scope.rangeCount=null}function prevShortcutSelection(){if(scope.dateObj.hideStartDatePicker){return}scope.rangeSelection='last';scope.focusStartDate=true;scope.focusEndDate=false;scope.activeRange=null;scope.rangeCount=null}function closeAlert(){scope.endDateValidation=true;scope.dateValidation=true}function onOutsideCalendarClick(){if(scope.dateObj.openDatepickerRange){scope.onOutsideCalendarClickCallback()}scope.dateObj.openDatepickerRange=false}function openRangePicker(e){scope.dateObj.openDatepickerRange=true;$timeout(function(){scope.dateObj.startDate=scope.dateObj.startDatepicker;scope.dateObj.endDate=scope.dateObj.endDatepicker},1);if(scope.dateObj.startDate){scope.dateObj.startDate=new Date(scope.dateObj.startDate.setHours(0,0,0,0))}if(scope.dateObj.endDate){scope.dateObj.endDate=new Date(scope.dateObj.endDate.setHours(0,0,0,0))}if(scope.maxDate&&scope.dateObj.endDate){if(scope.dateObj.endDate.toLocaleDateString()===scope.maxDate.toLocaleDateString()){scope.disableNext=true;scope.dateObj.rangeSelection='last'}else{scope.disableNext=false}}if(scope.minDate&&scope.dateObj.startDate){if(scope.dateObj.startDate.toLocaleDateString()===scope.minDate.toLocaleDateString()){scope.disableLast=true;scope.dateObj.rangeSelection='next'}else{scope.disableLast=false}}if(!scope.dateObj.startDate&&!scope.dateObj.endDate){$timeout(function(){$('td[class*=md-calendar-date-today]').attr('class','md-calendar-date')},100)}var dropdown=$(e.target).closest('.dropdown').find('.md-datepicker-dropdown');$timeout(function(){if(scope.dateObj.openDatepickerRange){$('.dropdown.open').removeClass('open');$(e.target).closest('.dropdown').addClass('open');$(dropdown).position({my:"left bottom - 2",at:"left top",of:$(e.target).closest('.dropdown')})}},10)}function clearDate(e){removeXIconClass(e);if(!scope.dateObj.hideStartDatePicker){scope.dateObj.startDate=null;scope.dateObj.startDatepicker=null}scope.dateObj.endDate=null;scope.dateObj.endDatepicker=null;scope.rangeCount=0}function close(){scope.dateObj.openDatepickerRange=false;scope.dateObj.startDatepicker=scope.dateObj.startDate;scope.dateObj.endDatepicker=scope.dateObj.endDate;scope.customCallback()}function selectRange(range,count){scope.rangeOption=true;scope.activeRange=range;scope.rangeCount=count;let firstDate=scope.dateObj.startDatepicker==null||scope.dateObj.startDatepicker==''?new Date:new Date(scope.dateObj.startDate);let nextDate=scope.dateObj.endDatepicker==null||scope.dateObj.startDatepicker==''?new Date:new Date(scope.dateObj.endDate);switch(range){case'today':firstDate=new Date;nextDate=new Date;if(!scope.dateObj.hideStartDatePicker){scope.dateObj.startDate=firstDate;scope.dateObj.startDatepicker=firstDate}scope.dateObj.endDate=nextDate;scope.dateObj.endDatepicker=nextDate;break;case'days':firstDate=new Date;nextDate=new Date;if(scope.dateObj.rangeSelection==='last'){firstDate.setDate(firstDate.getDate()-1*scope.rangeCount);scope.dateObj.startDate=firstDate;scope.dateObj.startDatepicker=firstDate}else{nextDate.setDate(nextDate.getDate()+1*scope.rangeCount);scope.dateObj.startDate=nextDate;scope.dateObj.startDatepicker=nextDate}scope.dateObj.endDate=nextDate;scope.dateObj.endDatepicker=nextDate;break;case'weeks':if(scope.rangeSelection=='last'){firstDate=new Date(nextDate);firstDate.setDate(firstDate.getDate()-7*scope.rangeCount);scope.dateObj.startDatepicker=firstDate;scope.focusStartDate=true;scope.focusEndDate=false}else{nextDate=new Date(firstDate);nextDate.setDate(nextDate.getDate()+7*scope.rangeCount);scope.dateObj.endDatepicker=nextDate;scope.focusStartDate=false;scope.focusEndDate=true}break;case'months':if(scope.rangeSelection=='last'){firstDate=new Date(nextDate);firstDate.setMonth(firstDate.getMonth()-scope.rangeCount);scope.dateObj.startDatepicker=firstDate;scope.focusStartDate=true;scope.focusEndDate=false}else{nextDate=new Date(firstDate);nextDate.setMonth(nextDate.getMonth()+scope.rangeCount);scope.dateObj.endDatepicker=nextDate;scope.focusStartDate=false;scope.focusEndDate=true}break;case'year':if(scope.rangeSelection=='last'){firstDate=new Date(nextDate);firstDate.setFullYear(firstDate.getFullYear()-scope.rangeCount);scope.dateObj.startDatepicker=firstDate;scope.focusStartDate=true;scope.focusEndDate=false}else{nextDate=new Date(firstDate);nextDate.setFullYear(nextDate.getFullYear()+scope.rangeCount);scope.dateObj.endDatepicker=nextDate;scope.focusStartDate=false;scope.focusEndDate=true}break;case'default':if(!scope.dateObj.hideStartDatePicker){scope.dateObj.startDate=firstDate}scope.dateObj.endDate=nextDate;break}if(!scope.dateObj.hideStartDatePicker){scope.dateObj.startDate=firstDate}scope.dateObj.endDate=nextDate}angular.element('input[type="date"]').on('click',function(e){e.preventDefault()});element.on('keyup',function(){executeValidationOnTimeOut()});element.on('keydown',function(){clearTimeout(timeoutReference)});function cleanUp(){if(timeoutReference){clearTimeout(timeoutReference)}}scope.$on('$destroy',cleanUp);scope.$on("virtualScroll",function(selfEve,data){setTimeout(function(){addStyling(data)},200)});let listener=scope.$watch(function(){return scope.dateObj.startDatepicker},function(){if(!scope.dateObj.readOnly||!scope.dateObj.readOnly.inputField){resetXIcon()}});let listener2=scope.$watch(function(){return scope.dateObj.endDatepicker},function(){if(!scope.dateObj.readOnly||!scope.dateObj.readOnly.inputField){resetXIcon()}});scope.$on("$destroy",function(){listener();listener2()})},controller:function($log,$scope){$scope.onDateChanged=onDateChanged;$scope.triggerClick=triggerClick;$scope.triggerEndClick=triggerEndClick;var currentDateString=new Date((new Date).setHours(0,0,0,0));function onDateChanged(){$scope.rangeOption=false;$scope.dateObj.startDatepicker=$scope.dateObj.startDate;$scope.dateObj.endDatepicker=$scope.dateObj.endDate;$scope.$on("selectPicker",function(data,text){if(!$scope.rangeOption){$scope.focusStartDate=false;$scope.focusEndDate=false;let direction=text.$element[0].ariaLabel;direction=='start'?$scope.focusStartDate=true:$scope.focusEndDate=true}});if($scope.dateObj.startDatepicker.toDateString()==currentDateString.toDateString()&&$scope.dateObj.endDatepicker.toDateString()==currentDateString.toDateString()){$scope.activeRange='today'}else{$scope.activeRange=''}if(new Date($scope.dateObj.startDate)>new Date($scope.dateObj.endDate)){$scope.errMessage='End Date should be greater than Start Date';return false}else{$scope.errMessage=''}}function triggerClick($event){$($event.currentTarget).closest('.start-date').find('tbody').find('.the-selected').trigger('click')}function triggerEndClick($event){$($event.currentTarget).closest('.end-date').find('tbody').find('.the-selected').trigger('click')}}}});function resetXIcon(){let datePickerElem=document.getElementsByClassName("md-datepicker-container");for(let y=0;y<datePickerElem.length;y++){let inputElem=datePickerElem[y].querySelectorAll('input');for(let x=0;x<inputElem.length;x++){if(inputElem[x]!==null&&inputElem[x].value!==''){$(inputElem[x]).addClass('x onX')}}}}function removeXIconClass(e){let inputElem=e.target.closest(".md-datepicker-container").querySelectorAll('input');for(let x=0;x<inputElem.length;x++){$(inputElem[x]).removeClass('x onX').val(undefined)}}})();
let fileTransferService={upload:function(fileObject,filename,filepath,otherFormData,validExtensionByModules,transform,moduleName){return $.Deferred(function(dfd){fileTransferService.validateUpload(fileObject,filename,validExtensionByModules).then(function(fileObject){var formData=new FormData;formData.append(fileObject[0].name,fileObject[0]);for(var key in otherFormData){formData.append(key,otherFormData[key])}if(!transform){transform=""}if(!moduleName){moduleName=""}let queryParameter={operation:"upload",filename:filename,filepath:filepath,transformInput:transform,moduleName:moduleName};const fileTransferEncKey=sessionStorage.getItem("crypto_aesKey_fileTransfer");const fileTransferEncIV=sessionStorage.getItem("crypto_aesIv_fileTransfer");let queryString=$.param(queryParameter);try{if('no'!==getItemKeyValue("EncryptFileTransferParameter").toLowerCase()&&fileTransferEncKey&&fileTransferEncIV&&fileTransferEncIV.length>0&&fileTransferEncKey.length>0){queryString="t="+encodeURIComponent(encryptDataWithAES(JSON.stringify(queryParameter),fileTransferEncKey,fileTransferEncIV))}}catch(e){console.warn("Encryption fail for file transfer")}var url=makeURL("/mobiledoc/ecwimage?"+queryString);$.ajax({url:url,type:'POST',mimeType:"multipart/form-data",contentType:false,cache:false,processData:false,data:formData,success:function(data){dfd.resolve(data)},error:function(error){try{console.log(error);ecwAlert($.parseHTML(data.responseText)[5].innerHTML.replace("<b>Message</b>","").trim());dfd.reject(error)}catch(e){dfd.reject(error)}}})},function(error){if(error&&error.includes("File size exceeds")){var scope=getPDFTronScope();scope.fileSizeExceedQuickFix()}else{ecwAlert(error,"Error")}dfd.reject(error)})})},validateUpload:function(fileObject,filename,validExtensionByModules){return $.Deferred(function(dfd){var errorMessage="";var promiseArrayList=[];for(var index=0;index<fileObject.length;index++){try{fileTransferValidation.validateFileName(filename);fileTransferValidation.validateFileName(fileObject[index].name)}catch(e){errorMessage+=e+"<br>"}try{fileTransferValidation.validateMatchingExtension(fileObject[index].name,filename)}catch(e){errorMessage+=e+"<br>"}try{fileTransferValidation.validateFileSize(fileObject[index])}catch(e){errorMessage+=e+"<br>"}promiseArrayList.push(fileTransferValidation.validateFileContent(fileObject[index],validExtensionByModules))}Promise.all(promiseArrayList).then(function(responseFileObj){if(errorMessage){dfd.reject(errorMessage)}else{dfd.resolve(responseFileObj)}})["catch"](function(e){errorMessage+=e+"<br>";dfd.reject(errorMessage)})})},download:function(filename,filepath,onLocalServer,otherParameters){return $.Deferred(function(dfd){fileTransferValidation.validateFileName(filename);fileTransferValidation.validateFileExtension(filename);var data={};if(otherParameters){data=otherParameters}data["operation"]='download';data["filename"]=filename;data["filepath"]=filepath;var url=makeURL("/mobiledoc/ecwimage");if(onLocalServer){data["onLocalServer"]='Yes'}$.ajax({url:url,type:'POST',success:function(data){dfd.resolve(data)},error:function(error){try{ecwAlert($.parseHTML(data.responseText)[5].innerHTML.replace("<b>Message</b>","").trim());dfd.reject(error)}catch(e){dfd.reject(error)}}})})}};getCryptoAesKey('fileTransfer','','',function(){},function(){});
angular.module('StandingOrdersDirective',[]).directive('labStandingOrders',function($http,$timeout,$filter){return{restrict:'AE',scope:{topclass:'@',standingOrderRequestObj:'=standingOrderRequestObj',standingOrderResponseObj:'=standingOrderResponseObj',setOrderDetails:'&'},templateUrl:makeURL('/mobiledoc/jsp/webemr/progressnotes/treatment/standingOrders.jsp'),link:function(scope,element,attributes){scope.getDefaultParamForStOrdDir=function(){var obj={stOrderCount:1,oOrderDates:[]};return obj};scope.oStandingOrderObj=scope.getDefaultParamForStOrdDir();scope.oStandingOrdersItem=[];scope.oStandingOrdersType="";scope.addDateToStOrderObj=function(sDateReq){var sDate=new Date;var stDate="";var sOrderDateObj=[];var nCt=0;if(scope.oStandingOrderObj.stOrderCount<=0)nCt=1;else nCt=scope.oStandingOrderObj.stOrderCount;for(var j=0;j<nCt;j++){sDate=scope.addDateVal(sDate,sDateReq);stDate=scope.formatDate(sDate,"mm/dd/yyyy");sOrderDateObj={sOrderDate:stDate};scope.oStandingOrderObj.oOrderDates.push(sOrderDateObj)}};scope.clearStandingOrderDts=function(){scope.oStandingOrderObj.oOrderDates=[];scope.oStandingOrderObj.stOrderCount=1;scope.oStandingOrdersItem=[];scope.oStandingOrdersType="";scope.clearStandingOrderHTML()};$('.standorder-div').on("hide",scope.clearStandingOrderDts);scope.$on("$destroy",function(){$('.standorder-div').off("hide",scope.clearStandingOrderDts)});scope.delDateFromStOrderObj=function(index){scope.oStandingOrderObj.oOrderDates.splice(index,1)};scope.saveStandingOrdersData=function(){if(scope.oStandingOrderObj.oOrderDates&&scope.oStandingOrderObj.oOrderDates.length>0){scope.standingOrderResponseObj.obj=scope.oStandingOrderObj;scope.setOrderDetails();scope.oStandingOrderObj=scope.getDefaultParamForStOrdDir()}scope.clearStandingOrderHTML()};scope.clearStandingOrderHTML=function(){$('.standorder-div').hide()};scope.addDateVal=function(todaysDate,addDateValue){if(addDateValue=="2D")todaysDate.setDate(todaysDate.getDate()+2);else if(addDateValue=="3D")todaysDate.setDate(todaysDate.getDate()+3);else if(addDateValue=="1W")todaysDate.setDate(todaysDate.getDate()+7);else if(addDateValue=="2W")todaysDate.setDate(todaysDate.getDate()+14);else if(addDateValue=="3W")todaysDate.setDate(todaysDate.getDate()+21);else if(addDateValue=="4W")todaysDate.setDate(todaysDate.getDate()+28);else if(addDateValue=="6W")todaysDate.setDate(todaysDate.getDate()+42);else if(addDateValue=="2M")todaysDate.setMonth(todaysDate.getMonth()+2);else if(addDateValue=="3M")todaysDate.setMonth(todaysDate.getMonth()+3);else if(addDateValue=="4M")todaysDate.setMonth(todaysDate.getMonth()+4);else if(addDateValue=="6M")todaysDate.setMonth(todaysDate.getMonth()+6);else if(addDateValue=="1Y")todaysDate.setMonth(todaysDate.getMonth()+12);else if(addDateValue=="2Y")todaysDate.setMonth(todaysDate.getMonth()+24);else if(addDateValue=="3Y")todaysDate.setMonth(todaysDate.getMonth()+36);return todaysDate};scope.formatDate=function(strDate,formatType){var strSupMonth=strDate.getMonth()+1;var strSupDay=strDate.getDate();var strSupYear=strDate.getFullYear();strDate=strSupYear+"-"+strSupMonth+"-"+strSupDay;var dt=strDate.split("-");var month="";var day="";var year="";var returnDate="";if(strDate==null||strDate==""||strDate=="0000-00-00"||strDate=="1901-01-01"||strDate=="1900-01-01")return"";if(dt.length==3){for(var i=0;i<dt.length;i++){if(i==1){month=dt[i];if(month.length<2)month="0"+month}if(i==2){day=dt[i];if(day.length<2)day="0"+day}if(i==0){year=dt[i]}}}else return"";if(month==""||day==""||year=="")return"";else{if(formatType=="mm/dd/yyyy")returnDate=month+"/"+day+"/"+year;else if(formatType=="yyyy-mm-dd")returnDate=year+"-"+month+"-"+day}return returnDate}}}});